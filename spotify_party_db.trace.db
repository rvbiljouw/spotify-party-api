2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "ACCOUNT" not found; SQL statement:
alter table account drop constraint if exists fk_account_subscription_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "ACCOUNT" not found; SQL statement:
alter table account drop constraint if exists fk_account_active_party_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "ACCOUNT" not found; SQL statement:
alter table account drop constraint if exists fk_account_spotify_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "ACCOUNT" not found; SQL statement:
alter table account drop constraint if exists fk_account_login_token_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "ACCOUNT_ACHIEVEMENT" not found; SQL statement:
alter table account_achievement drop constraint if exists fk_account_achievement_account [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "ACCOUNT_ACHIEVEMENT" not found; SQL statement:
alter table account_achievement drop constraint if exists fk_account_achievement_achievement [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "ACCOUNT_LINK" not found; SQL statement:
alter table account_link drop constraint if exists fk_account_link_account_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "LOGIN_TOKEN" not found; SQL statement:
alter table login_token drop constraint if exists fk_login_token_account_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "PARTY" not found; SQL statement:
alter table party drop constraint if exists fk_party_owner_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "PARTY" not found; SQL statement:
alter table party drop constraint if exists fk_party_now_playing_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "PARTY_MEMBER" not found; SQL statement:
alter table party_member drop constraint if exists fk_party_member_party_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "PARTY_MEMBER" not found; SQL statement:
alter table party_member drop constraint if exists fk_party_member_account_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "PARTY_QUEUE_ENTRY" not found; SQL statement:
alter table party_queue_entry drop constraint if exists fk_party_queue_entry_party_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "PARTY_QUEUE_ENTRY" not found; SQL statement:
alter table party_queue_entry drop constraint if exists fk_party_queue_entry_member_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "PARTY_QUEUE_VOTE" not found; SQL statement:
alter table party_queue_vote drop constraint if exists fk_party_queue_vote_account_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "PARTY_QUEUE_VOTE" not found; SQL statement:
alter table party_queue_vote drop constraint if exists fk_party_queue_vote_entry_id [42102-196]
2017-11-06 12:06:14 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "SPOTIFY_ACCOUNT" not found; SQL statement:
alter table spotify_account drop constraint if exists fk_spotify_account_account_id [42102-196]
2017-11-07 14:15:35 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-196]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:345)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.message.DbException.get(DbException.java:144)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1484)
	at org.h2.jdbc.JdbcConnection.checkClosedForWrite(JdbcConnection.java:1469)
	at org.h2.jdbc.JdbcConnection.commit(JdbcConnection.java:476)
	at org.avaje.datasource.pool.PooledConnection.commit(PooledConnection.java:666)
	at io.ebeaninternal.server.transaction.JdbcTransaction.performCommit(JdbcTransaction.java:927)
	at io.ebeaninternal.server.transaction.JdbcTransaction.flushCommitAndNotify(JdbcTransaction.java:937)
	at io.ebeaninternal.server.transaction.JdbcTransaction.commit(JdbcTransaction.java:986)
	at io.ebeaninternal.server.core.OrmQueryRequest.endTransIfRequired(OrmQueryRequest.java:280)
	at io.ebeaninternal.server.core.DefaultServer.findList(DefaultServer.java:1500)
	at io.ebeaninternal.server.query.LimitOffsetPagedList.getList(LimitOffsetPagedList.java:64)
	at uk.bipush.party.task.TokenRefresher.run(TokenRefresher.kt:37)
	at uk.bipush.party.util.ExpireableRunnable$run$1.call(ExpireableRunnable.kt:16)
	at uk.bipush.party.util.ExpireableRunnable$run$1.call(ExpireableRunnable.kt:7)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2017-11-07 14:15:35 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-196]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:345)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.message.DbException.get(DbException.java:144)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1484)
	at org.h2.jdbc.JdbcConnection.checkClosedForWrite(JdbcConnection.java:1469)
	at org.h2.jdbc.JdbcConnection.rollback(JdbcConnection.java:498)
	at org.avaje.datasource.pool.PooledConnection.rollback(PooledConnection.java:759)
	at io.ebeaninternal.server.transaction.JdbcTransaction.performRollback(JdbcTransaction.java:920)
	at io.ebeaninternal.server.transaction.JdbcTransaction.doRollback(JdbcTransaction.java:1078)
	at io.ebeaninternal.server.transaction.JdbcTransaction.commit(JdbcTransaction.java:990)
	at io.ebeaninternal.server.core.OrmQueryRequest.endTransIfRequired(OrmQueryRequest.java:280)
	at io.ebeaninternal.server.core.DefaultServer.findList(DefaultServer.java:1500)
	at io.ebeaninternal.server.query.LimitOffsetPagedList.getList(LimitOffsetPagedList.java:64)
	at uk.bipush.party.task.TokenRefresher.run(TokenRefresher.kt:37)
	at uk.bipush.party.util.ExpireableRunnable$run$1.call(ExpireableRunnable.kt:16)
	at uk.bipush.party.util.ExpireableRunnable$run$1.call(ExpireableRunnable.kt:7)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2017-11-09 11:26:53 jdbc[8]: exception
org.h2.jdbc.JdbcSQLException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-196]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:345)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.message.DbException.get(DbException.java:144)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1484)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1459)
	at org.h2.jdbc.JdbcConnection.getAutoCommit(JdbcConnection.java:458)
	at org.avaje.datasource.pool.PooledConnection.getAutoCommit(PooledConnection.java:677)
	at io.ebeaninternal.server.transaction.JdbcTransaction.checkAutoCommit(JdbcTransaction.java:209)
	at io.ebeaninternal.server.transaction.JdbcTransaction.<init>(JdbcTransaction.java:197)
	at io.ebeaninternal.server.transaction.TransactionManager.createTransaction(TransactionManager.java:257)
	at io.ebeaninternal.server.transaction.TransactionFactoryBasic.create(TransactionFactoryBasic.java:38)
	at io.ebeaninternal.server.transaction.TransactionFactoryBasic.createQueryTransaction(TransactionFactoryBasic.java:25)
	at io.ebeaninternal.server.transaction.TransactionManager.createQueryTransaction(TransactionManager.java:250)
	at io.ebeaninternal.server.core.DefaultServer.createQueryTransaction(DefaultServer.java:2147)
	at io.ebeaninternal.server.core.OrmQueryRequest.initTransIfRequired(OrmQueryRequest.java:215)
	at io.ebeaninternal.server.core.DefaultServer.findList(DefaultServer.java:1496)
	at io.ebeaninternal.server.query.LimitOffsetPagedList.getList(LimitOffsetPagedList.java:64)
	at uk.bipush.party.task.TokenRefresher.run(TokenRefresher.kt:37)
	at uk.bipush.party.util.ExpireableRunnable$run$1.call(ExpireableRunnable.kt:16)
	at uk.bipush.party.util.ExpireableRunnable$run$1.call(ExpireableRunnable.kt:7)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2018-01-13 00:01:57 jdbc[6]: exception
org.h2.jdbc.JdbcSQLException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-196]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:345)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.message.DbException.get(DbException.java:144)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1484)
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1459)
	at org.h2.jdbc.JdbcConnection.getAutoCommit(JdbcConnection.java:458)
	at org.avaje.datasource.pool.PooledConnection.getAutoCommit(PooledConnection.java:677)
	at io.ebeaninternal.server.transaction.JdbcTransaction.checkAutoCommit(JdbcTransaction.java:209)
	at io.ebeaninternal.server.transaction.JdbcTransaction.<init>(JdbcTransaction.java:197)
	at io.ebeaninternal.server.transaction.TransactionManager.createTransaction(TransactionManager.java:257)
	at io.ebeaninternal.server.transaction.TransactionFactoryBasic.create(TransactionFactoryBasic.java:38)
	at io.ebeaninternal.server.transaction.TransactionFactoryBasic.createQueryTransaction(TransactionFactoryBasic.java:25)
	at io.ebeaninternal.server.transaction.TransactionManager.createQueryTransaction(TransactionManager.java:250)
	at io.ebeaninternal.server.core.DefaultServer.createQueryTransaction(DefaultServer.java:2147)
	at io.ebeaninternal.server.core.OrmQueryRequest.initTransIfRequired(OrmQueryRequest.java:215)
	at io.ebeaninternal.server.core.DefaultServer.findId(DefaultServer.java:1169)
	at io.ebeaninternal.server.core.DefaultServer.find(DefaultServer.java:1062)
	at io.ebeaninternal.server.core.DefaultServer.find(DefaultServer.java:1048)
	at io.ebean.Finder.byId(Finder.java:132)
	at uk.bipush.party.handler.YouTubePartyManager.playNext(YouTubePartyManager.kt:68)
	at uk.bipush.party.handler.YouTubePartyManager$playNext$4.run(YouTubePartyManager.kt:114)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2018-01-30 15:44:48 database: flush
org.h2.message.DbException: General error: "java.lang.IllegalStateException: The file is locked: nio:/Users/jackh/spotify-party-api/spotify_party_db.mv.db [1.4.196/7]" [50000-196]
	at org.h2.message.DbException.get(DbException.java:168)
	at org.h2.message.DbException.convert(DbException.java:295)
	at org.h2.mvstore.db.MVTableEngine$1.uncaughtException(MVTableEngine.java:95)
	at org.h2.mvstore.MVStore.panic(MVStore.java:378)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:361)
	at org.h2.mvstore.MVStore$Builder.open(MVStore.java:2930)
	at org.h2.mvstore.db.MVTableEngine$Store.open(MVTableEngine.java:155)
	at org.h2.mvstore.db.MVTableEngine.init(MVTableEngine.java:100)
	at org.h2.engine.Database.getPageStore(Database.java:2476)
	at org.h2.engine.Database.open(Database.java:697)
	at org.h2.engine.Database.openDatabase(Database.java:276)
	at org.h2.engine.Database.<init>(Database.java:270)
	at org.h2.engine.Engine.openSession(Engine.java:64)
	at org.h2.engine.Engine.openSession(Engine.java:176)
	at org.h2.engine.Engine.createSessionAndValidate(Engine.java:154)
	at org.h2.engine.Engine.createSession(Engine.java:137)
	at org.h2.engine.Engine.createSession(Engine.java:27)
	at org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:354)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:116)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:100)
	at org.h2.Driver.connect(Driver.java:69)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.avaje.datasource.pool.ConnectionPool.createUnpooledConnection(ConnectionPool.java:429)
	at org.avaje.datasource.pool.ConnectionPool.createConnectionForQueue(ConnectionPool.java:662)
	at org.avaje.datasource.pool.PooledConnectionQueue.ensureMinimumConnections(PooledConnectionQueue.java:228)
	at org.avaje.datasource.pool.ConnectionPool.initialise(ConnectionPool.java:272)
	at org.avaje.datasource.pool.ConnectionPool.<init>(ConnectionPool.java:222)
	at org.avaje.datasource.Factory.createPool(Factory.java:12)
	at io.ebeaninternal.server.core.DefaultContainer.getDataSourceFromConfig(DefaultContainer.java:310)
	at io.ebeaninternal.server.core.DefaultContainer.setDataSource(DefaultContainer.java:265)
	at io.ebeaninternal.server.core.DefaultContainer.createServer(DefaultContainer.java:108)
	at io.ebeaninternal.server.core.DefaultContainer.createServer(DefaultContainer.java:44)
	at io.ebean.EbeanServerFactory.createInternal(EbeanServerFactory.java:108)
	at io.ebean.EbeanServerFactory.create(EbeanServerFactory.java:67)
	at uk.bipush.party.Application.bootstrapEbean(Application.kt:39)
	at uk.bipush.party.Application.main(Application.kt:50)
Caused by: org.h2.jdbc.JdbcSQLException: General error: "java.lang.IllegalStateException: The file is locked: nio:/Users/jackh/spotify-party-api/spotify_party_db.mv.db [1.4.196/7]" [50000-196]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:345)
	... 37 more
Caused by: java.lang.IllegalStateException: The file is locked: nio:/Users/jackh/spotify-party-api/spotify_party_db.mv.db [1.4.196/7]
	at org.h2.mvstore.DataUtils.newIllegalStateException(DataUtils.java:765)
	at org.h2.mvstore.FileStore.open(FileStore.java:173)
	at org.h2.mvstore.MVStore.<init>(MVStore.java:347)
	... 32 more
2018-01-31 11:07:46 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Table "FAVOURITE_SONG" not found; SQL statement:
alter table favourite_song drop constraint if exists fk_favourite_song_account_id [42102-196]
